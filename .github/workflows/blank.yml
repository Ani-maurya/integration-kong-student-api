---
name: Kong API Gateway Workflow
on:
  push:
    branches:
      - main
jobs:
  OAS_TO_Kong:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v2

      - name: Check head on main or not
        run: |
        if: github.ref == 'refs/heads/main'

      - name: download jq
        run: |
          sudo apt install jq -y
          jq --version

      - name: download yq
        run: |
          sudo snap install yq
          yq --version

      - name: Install deck CLI
        run: >
          curl -sL
          https://github.com/kong/deck/releases/download/v1.34.0/deck_1.34.0_linux_amd64.tar.gz
          -o deck.tar.gz

          tar -xf deck.tar.gz -C /tmp 

          sudo cp /tmp/deck /usr/local/bin/

          deck file openapi2kong -s test.yaml --select-tag=dev -o kong.yaml

      - name: Append Plugins to new-api.yaml
        run: >
          if [ "${{ vars.KEY_AUTH }}" == "true" ] || [ "${{ vars.RATE_LIMITING }}" ==
          "true" ] || [ "${{ vars.REQUEST_SIZE_LIMITING }}" == "true" ] || [
          "${{ vars.HTTP_LOG }}" == "true" ] || [ "${{ vars.IP_RESTRICTION }}" ==
          "true" ] || [ "${{ vars.ACL }}" == "true" ] || [
          "${{ vars.OAS_VALIDATION }}" == "true" ] || [ "${{ vars.OPENID_CONNECT }}" ==
          "true" ] || [ "${{ vars.CORRELATION_ID }}" ==
          "true" ]; then
             sed -i '1,2d' ratelimiting.yaml acl.yaml http-log.yaml request-size-limiting.yaml ip-restriction.yaml oas-validation.yaml correlation.yaml open-id.yaml
             sed -i '1d' keyauth.yaml
             cat keyauth.yaml ratelimiting.yaml request-size-limiting.yaml acl.yaml http-log.yaml  ip-restriction.yaml oas-validation.yaml correlation.yaml open-id.yaml > combined-plugins.yaml
             cat combined-plugins.yaml
             export plugins=$(cat combined-plugins.yaml)
             echo $plugins
             cat kong.yaml | yq '.services.[] += env(plugins)' -o yaml > modified-api.yaml
             # cat new-api.yaml | yq '.services.[] += env(plugins)' -o yaml > modified-api.yaml
          fi

      - name: Set headers and run deck sync
        run: >
          cat modified-api.yaml
          
          # deck file openapi2kong -s test.yaml --select-tag=dev -o kong.yaml

          deck gateway sync  --select-tag dev modified-api.yaml --konnect-token ${{ secrets.DECK_TOKEN }} --konnect-control-plane-name ${{ vars.DECK_CONTROL_PLANE_NAME }}
          
  publish-customer-api-to-portal:
    name: Publish OAS to dev portal
    needs: OAS_TO_Kong
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v2

      - name: Fech environment variables
        id: set_env_vars
        run: |
          echo "API_PRODUCT_NAME: ${{ vars.API_PRODUCT_NAME }}"
          echo "CONTROL_PLANE_NAME: ${{ vars.CONTROL_PLANE_NAME }}" 
          echo "GATEWAY_SERVICE_NAME: ${{ vars.GATEWAY_SERVICE_NAME }}" 

      - name: Create API product
        run: |
          curl --request POST \
            --url https://us.api.konghq.com/v2/api-products \
            --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
            --header 'Content-Type: application/json' \
            --data '{
              "name": "${{ vars.API_PRODUCT_NAME }}",
              "description": "Creating through admin api",
              "labels": {}
            }' 

      - name: Get API product ID
        run: >
          api_product_name="${{ vars.API_PRODUCT_NAME }}"

          api_product_id=$(curl --request GET \
            --url https://us.api.konghq.com/v2/api-products \
            --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
            | jq -r --arg api_product_name "$api_product_name" '.data[] | select(.name == $api_product_name) | .id // empty')

          if [ "$api_product_id" = "empty" ]; then
            echo "Error: API Product ID not found."
            exit 1
          fi

          echo "API_PRODUCT_ID=$api_product_id" >> $GITHUB_ENV 

      - name: Get Dev Portal ID
        run: |
          Dev_portal_id=$(curl --request GET \
            --url https://us.api.konghq.com/v2/portals \
            --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
            | jq -r '.data[].id')
              echo "DEV_PORTAL_ID=$Dev_portal_id" >> $GITHUB_ENV

      - name: Publish product to the dev portal
        run: |
          echo "API Product ID: $API_PRODUCT_ID"
          echo "Dev Portal ID: $DEV_PORTAL_ID"
          curl --request PATCH \
           --url https://us.api.konghq.com/v2/api-products/$API_PRODUCT_ID \
           --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
           --header 'Content-Type: application/json' \
           --data "{
             \"portal_ids\":[\"$DEV_PORTAL_ID\"]
           }"

      - name: Create the product version
        run: >
          echo "API Product ID: $API_PRODUCT_ID"

          api_product_version_id=$(curl --request POST \
            --url https://us.api.konghq.com/v2/api-products/$API_PRODUCT_ID/product-versions \
            --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
            --header 'Content-Type: application/json' \
            --data '{
              "name": "v1",
              "publish_status": "published",
              "gateway_service": null
            }'| jq -r '.id')
              echo "API_Product_Version_ID=$api_product_version_id" >> $GITHUB_ENV
              echo "API Product Version ID: $API_Product_Version_ID"

      - name: Get Control Plane ID
        run: >
          control_plane_name="${{ vars.CONTROL_PLANE_NAME }}"

          control_plane_id=$(curl --location 'https://us.api.konghq.com/v2/control-planes' \

          --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \

          | jq -r --arg control_plane_name "$control_plane_name" '.data[] | select(.name == $control_plane_name) | .id')

          echo "Control_Plane_ID=$control_plane_id" >> $GITHUB_ENV

      - name: Get Service ID
        run: >
          echo "Control Plane Id: $Control_Plane_ID"

          gateway_service_name="${{ vars.GATEWAY_SERVICE_NAME }}"

          service_id=$(curl --location "https://us.api.konghq.com/v2/control-planes/$Control_Plane_ID/core-entities/services" \
            --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
            | jq -r --arg gateway_service_name "$gateway_service_name" '.data[] | select(.name == $gateway_service_name) | .id')
          echo "Service_ID=$service_id" >> $GITHUB_ENV

      - name: Link service to the product version
        run: >
          echo "API PRODUCT ID: $API_PRODUCT_ID"

          echo "Control Plane ID: $Control_Plane_ID"

          echo "Service ID: $Service_ID"

          echo "API Product Version ID: $API_Product_Version_ID"

          curl --location --request PATCH "https://us.api.konghq.com/v2/api-products/$API_PRODUCT_ID/product-versions/$API_Product_Version_ID" \
                --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
                --header 'Content-Type: application/json' \
                --data "{
                        \"name\": \"v1\",
                        \"publish_status\": \"published\",
                        \"deprecated\": false,
                        \"notify\": true,
                        \"gateway_service\": {
                        \"control_plane_id\": \"$Control_Plane_ID\",
                        \"id\": \"$Service_ID\"
                                }
                       }"

      - name: Upload spec on the version
        run: |
          echo "API PRODUCT ID: $API_PRODUCT_ID"
          echo "API Product Version ID: $API_Product_Version_ID"
          # encoded_spec=$(base64 student.yaml)
          # echo $encoded_spec
          # # echo $spec
          curl --location --request POST "https://us.api.konghq.com/v2/api-products/$API_PRODUCT_ID/product-versions/$API_Product_Version_ID/specifications" \
            --header 'Authorization: ${{ secrets.PIPELINE_TOKEN }}' \
            --header 'Content-Type: application/json' \
            --data '{
                    "name": "student.yaml", 
                    "content": "ewogICAgIm9wZW5hcGkiOiAiMy4wLjAiLAogICAgImluZm8iOiB7CiAgICAgICAgInRpdGxlIjogIlN0dWRlbnQgSW5mb3JtYXRpb24gQVBJIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAiIyMgU3R1ZGVudCBpbmZvcm1hdGlvbiBBUEkgIiwKICAgICAgICAiY29udGFjdCI6IHsKICAgICAgICAgICAgImVtYWlsIjogImludGVncmF0aW9udGVhbUBzaGVmZmllbGQuYWMudWsiCiAgICAgICAgfSwKICAgICAgICAidmVyc2lvbiI6ICIwLjAuMSIKICAgIH0sCiAgICAic2VydmVycyI6IFsKICAgICAgICB7CiAgICAgICAgICAgICJ1cmwiOiAiaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20vdjEiCiAgICAgICAgfQogICAgXSwKICAgICJ0YWdzIjogWwogICAgICAgIHsKICAgICAgICAgICAgIm5hbWUiOiAiR2V0U3R1ZGVudHMiLAogICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiR2V0IFN0dWRlbnRzIEluZm9ybWF0aW9uIgogICAgICAgIH0KICAgIF0sCiAgICAicGF0aHMiOiB7CiAgICAgICAgIi9zdHVkZW50UyI6IHsKICAgICAgICAgICAgImdldCI6IHsKICAgICAgICAgICAgICAgICJ0YWdzIjogWwogICAgICAgICAgICAgICAgICAgICJHZXRTdHVkZW50cyIKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAic3VtbWFyeSI6ICJSZXRyaWV2ZSBzdHVkZW50IGluZm9ybWF0aW9uIiwKICAgICAgICAgICAgICAgICJyZXF1ZXN0Qm9keSI6IHsKICAgICAgICAgICAgICAgICAgICAicmVxdWlyZWQiOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICJjb250ZW50IjogewogICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL2pzb24iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAib2JqZWN0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAicHJvcGVydGllcyI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJrZXkxIjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImtleTIiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImludGVnZXIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAicmVxdWlyZWQiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAia2V5MSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAia2V5MiIKICAgICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0sCgogICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlJldHVybnMgYSBsaXN0IG9mIHN0dWRlbnQgaW5mb3JtYXRpb24uIiwKICAgICAgICAgICAgICAgICJvcGVyYXRpb25JZCI6ICJnZXRTdHVkZW50cyIsCiAgICAgICAgICAgICAgICAicGFyYW1ldGVycyI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICIkcmVmIjogIiMvY29tcG9uZW50cy9wYXJhbWV0ZXJzL0F1dGhvcml6YXRpb25IZWFkZXIiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICIkcmVmIjogIiMvY29tcG9uZW50cy9wYXJhbWV0ZXJzL0NvbnRlbnRUeXBlSGVhZGVyIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAiJHJlZiI6ICIjL2NvbXBvbmVudHMvcGFyYW1ldGVycy9Db3JyZWxhdGlvbklkSGVhZGVyIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAiJHJlZiI6ICIjL2NvbXBvbmVudHMvcGFyYW1ldGVycy9SZXF1ZXN0SWRIZWFkZXIiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICIkcmVmIjogIiMvY29tcG9uZW50cy9wYXJhbWV0ZXJzL1Rlc3RIZWFkZXIiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogInN0dWRlbnRDb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImluIjogInF1ZXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkZpZWxkcyB0byBpbmNsdWRlIGluIHRoZSByZXNwb25zZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICJleGFtcGxlIjogInN1cm5hbWUsZW5yb2xsbWVudC5wcm9ncmFtbWUsIHByb2dyYW1tZSIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiAicmVnaXN0cmF0aW9uTnVtYmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgImluIjogInF1ZXJ5IiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlN0dWRlbnQgcmVnaXN0cmF0aW9uIG51bWJlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICJleGFtcGxlIjogMTEyMgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJyZWdpc3RyYXRpb25TdGF0dXMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaW4iOiAicXVlcnkiLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAic3R1ZGVudCByZWdpc3RyYXRpb24gc3RhdHVzIiwKICAgICAgICAgICAgICAgICAgICAgICAgInJlcXVpcmVkIjogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgInNjaGVtYSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAiYWN0aXZlIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJmaWVsZHMiLAogICAgICAgICAgICAgICAgICAgICAgICAiaW4iOiAicXVlcnkiLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiRmllbGRzIHRvIGluY2x1ZGUgaW4gdGhlIHJlc3BvbnNlLCBjdXJyZW50bHkgbm90IHVzZWQuIiwKICAgICAgICAgICAgICAgICAgICAgICAgInJlcXVpcmVkIjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICJleGFtcGxlIjogInN1cm5hbWUsZW5yb2xsbWVudC5wcm9ncmFtbWUsIHByb2dyYW1tZSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgInJlc3BvbnNlcyI6IHsKICAgICAgICAgICAgICAgICAgICAiMjAwIjogewogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQSBsaXN0IG9mIHN0dWRlbnQgaW5mb3JtYXRpb24uIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbnRlbnQiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXBwbGljYXRpb24vanNvbiI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2NoZW1hIjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJhcnJheSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpdGVtcyI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIkcmVmIjogIiMvY29tcG9uZW50cy9zY2hlbWFzL1N0dWRlbnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICI0MDAiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJCYWQgcmVxdWVzdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50IjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL2pzb24iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNjaGVtYSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiRyZWYiOiAiIy9jb21wb25lbnRzL3NjaGVtYXMvRXJyb3I0MDAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiNDAxIjogewogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiVW5hdXRob3JpemVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbnRlbnQiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXBwbGljYXRpb24vanNvbiI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2NoZW1hIjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJHJlZiI6ICIjL2NvbXBvbmVudHMvc2NoZW1hcy9FcnJvcjQwMSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICI0MDMiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJGb3JiaWRkZW4iLAogICAgICAgICAgICAgICAgICAgICAgICAiY29udGVudCI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi9qc29uIjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIkcmVmIjogIiMvY29tcG9uZW50cy9zY2hlbWFzL0Vycm9yNDAzIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgIjUwMCI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkludGVybmFsIFNlcnZlciBFcnJvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50IjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL2pzb24iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInNjaGVtYSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiRyZWYiOiAiIy9jb21wb25lbnRzL3NjaGVtYXMvRXJyb3I1MDAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICJzZWN1cml0eSI6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJiZWFyZXJBdXRoIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgInVvcy9zdHVkZW50LXJlYWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInVvcy9zdHVkZW50LXJlYWQtYWxsIgogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhcGlLZXkiOiBbXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICAiY29tcG9uZW50cyI6IHsKICAgICAgICAic2NoZW1hcyI6IHsKICAgICAgICAgICAgIlN0dWRlbnQiOiB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJvYmplY3QiLAogICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOiB7CiAgICAgICAgICAgICAgICAgICAgInRpdGxlIjogewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJpbnRlZ2VyIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBzdHVkZW50J3MgSUQuIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAxMjMKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJmb3JlbmFtZSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBzdHVkZW50J3MgZm9yZW5hbWUuIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAiQWxpY2UiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAia25vd25hcyI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRoZSBzdHVkZW50J3Mga25vd25hcyBuYW1lLiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJleGFtcGxlIjogIkpvaG4iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAibGFzdG5hbWUiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgc3R1ZGVudCdzIGtub3duYXMgbmFtZS4iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJKb2huIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgInVuaXZlcnNpdHlFbWFpbCI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgImZvcm1hdCI6ICJlbWFpbCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgc3R1ZGVudCdzIHVuaXZlcnNpdHkgZW1haWwuIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAiYWxpY2Uuc21pdGhAdW5pdmVyc2l0eS5lZHUiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAicnZEb21haW4iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUaGUgc3R1ZGVudCdzIGRvbWFpbi4iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJSRUdfU1RBVFVTX0dSUF9BVFQiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICAiRXJyb3I0MDAiOiB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJvYmplY3QiLAogICAgICAgICAgICAgICAgInJlcXVpcmVkIjogWwogICAgICAgICAgICAgICAgICAgICJjb2RlIiwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iLAogICAgICAgICAgICAgICAgICAgICJtZXNzYWdlIiwKICAgICAgICAgICAgICAgICAgICAic291cmNlIiwKICAgICAgICAgICAgICAgICAgICAidHlwZSIKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAicHJvcGVydGllcyI6IHsKICAgICAgICAgICAgICAgICAgICAiY29kZSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAibnVtYmVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIjUgZGlnaXQgZXJyb3IgbWVzc2FnZSBjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAxMDAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgImVudW0iOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMDAwMAogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJEZXNjcmlwdGlvbiBmb3IgdGhlIDUgZGlnaXQgIG1lc3NhZ2UgY29kZS4iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJSZXF1aXJlZCBmaWVsZHMgYXJlIG1pc3Npbmcgb3IgaW52YWxpZCBkYXRhIHNwZWNpZmllZCBpbiB0aGUgcmVxdWVzdC4gUGxlYXNlIHJlZmVyIHRvIHRoZSBBUEkgZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBkZXRhaWxzLiIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJzb3VyY2UiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJTb3VyY2Ugb2YgdGhlIG1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJNaWRkbGV3YXJlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImVudW0iOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQmFja2VuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiTWlkZGxld2FyZSIKICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgIm1lc3NhZ2UiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBbnkgbWVzc2FnZSBmb3IgdGhlIGNvbnN1bWluZyBzeXN0ZW0gZm9yIHVzZSBpbiBVSSBvciBpbiB0aGUgYXBwbGljYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJJbnZhbGlkIEpTT04iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAidHlwZSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlR5cGUgb2YgdGhlIG1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJWYWxpZGF0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgImVudW0iOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3lzdGVtIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCdXNpbmVzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsaWRhdGlvbiIKICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgIkVycm9yNDAxIjogewogICAgICAgICAgICAgICAgInR5cGUiOiAib2JqZWN0IiwKICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IFsKICAgICAgICAgICAgICAgICAgICAibWVzc2FnZSIsCiAgICAgICAgICAgICAgICAgICAgImh0dHBfc3RhdHVzX2NvZGUiCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOiB7CiAgICAgICAgICAgICAgICAgICAgIm1lc3NhZ2UiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBbnkgbWVzc2FnZSBmb3IgdGhlIGNvbnN1bWluZyBzeXN0ZW0gZm9yIHVzZSBpbiBVSSBvciBpbiB0aGUgYXBwbGljYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJVbmF1dGhvcml6ZWQgLSBFeHBpcmVkIFRva2VuLiIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJodHRwX3N0YXR1c19jb2RlIjogewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiSFRUUCByZXNwb25zZSBjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAiNDAxIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgIkVycm9yNDAzIjogewogICAgICAgICAgICAgICAgInR5cGUiOiAib2JqZWN0IiwKICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IFsKICAgICAgICAgICAgICAgICAgICAibWVzc2FnZSIsCiAgICAgICAgICAgICAgICAgICAgImh0dHBfc3RhdHVzX2NvZGUiCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOiB7CiAgICAgICAgICAgICAgICAgICAgIm1lc3NhZ2UiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBbnkgbWVzc2FnZSBmb3IgdGhlIGNvbnN1bWluZyBzeXN0ZW0gZm9yIHVzZSBpbiBVSSBvciBpbiB0aGUgYXBwbGljYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJBUEkgS2V5IGlzIG5vdCB2YWxpZCBvciBpcyBleHBpcmVkIC8gcmV2b2tlZC4iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiaHR0cF9zdGF0dXNfY29kZSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkhUVFAgcmVzcG9uc2UgY29kZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJleGFtcGxlIjogIjQwMyIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJFcnJvcjUwMCI6IHsKICAgICAgICAgICAgICAgICJ0eXBlIjogIm9iamVjdCIsCiAgICAgICAgICAgICAgICAicmVxdWlyZWQiOiBbCiAgICAgICAgICAgICAgICAgICAgImNvZGUiLAogICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgIm1lc3NhZ2UiLAogICAgICAgICAgICAgICAgICAgICJzb3VyY2UiLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIgogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogewogICAgICAgICAgICAgICAgICAgICJjb2RlIjogewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJudW1iZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiNSBkaWdpdCAgbWVzc2FnZSBjb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAyMDAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgImVudW0iOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAyMDAwMAogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJEZXNjcmlwdGlvbiBmb3IgdGhlIDUgZGlnaXQgIG1lc3NhZ2UgY29kZS4iLAogICAgICAgICAgICAgICAgICAgICAgICAiZXhhbXBsZSI6ICJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAic291cmNlIjogewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiU291cmNlIG9mIHRoZSBtZXNzYWdlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAiQmFja2VuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJlbnVtIjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkJhY2tlbmQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk1pZGRsZXdhcmUiCiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJtZXNzYWdlIjogewogICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQW55IG1lc3NhZ2UgZm9yIHRoZSBjb25zdW1pbmcgc3lzdGVtIGZvciB1c2UgaW4gVUkgb3IgaW4gdGhlIGFwcGxpY2F0aW9uIgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJUeXBlIG9mIHRoZSBtZXNzYWdlIiwKICAgICAgICAgICAgICAgICAgICAgICAgImV4YW1wbGUiOiAiU3lzdGVtIiwKICAgICAgICAgICAgICAgICAgICAgICAgImVudW0iOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiU3lzdGVtIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJCdXNpbmVzcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiVmFsaWRhdGlvbiIKICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgInBhcmFtZXRlcnMiOiB7CiAgICAgICAgICAgICJBdXRob3JpemF0aW9uSGVhZGVyIjogewogICAgICAgICAgICAgICAgIm5hbWUiOiAiQXV0aG9yaXphdGlvbiIsCiAgICAgICAgICAgICAgICAiaW4iOiAiaGVhZGVyIiwKICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IHRydWUsCiAgICAgICAgICAgICAgICAic2NoZW1hIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkJlYXJlciB0b2tlbiBmb3IgYXV0aGVudGljYXRpb24iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJDb250ZW50VHlwZUhlYWRlciI6IHsKICAgICAgICAgICAgICAgICJuYW1lIjogIkNvbnRlbnQtVHlwZSIsCiAgICAgICAgICAgICAgICAiaW4iOiAiaGVhZGVyIiwKICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IHRydWUsCiAgICAgICAgICAgICAgICAic2NoZW1hIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgImRlZmF1bHQiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgImVudW0iOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3htbCIKICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJDb3JyZWxhdGlvbklkSGVhZGVyIjogewogICAgICAgICAgICAgICAgIm5hbWUiOiAieC11b3MtY29ycmVsYXRpb24taWQiLAogICAgICAgICAgICAgICAgImluIjogImhlYWRlciIsCiAgICAgICAgICAgICAgICAicmVxdWlyZWQiOiB0cnVlLAogICAgICAgICAgICAgICAgInNjaGVtYSI6IHsKICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICJBIHVuaXF1ZSBpZGVudGlmaWVyIHVzZWQgYnkgY29uc3VtZXJzIG9yIHdpdGhpbiB0aGUgbWljcm9zZXJ2aWNlcyBsYXllciBpbiBhIGJ1c2luZXNzIHByb2Nlc3Mgam91cm5leS4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJSZXF1ZXN0SWRIZWFkZXIiOiB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJ4LXVvcy1yZXF1ZXN0LWlkIiwKICAgICAgICAgICAgICAgICJpbiI6ICJoZWFkZXIiLAogICAgICAgICAgICAgICAgInJlcXVpcmVkIjogdHJ1ZSwKICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiQSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIEFQSSByZXF1ZXN0LiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgIlRpbWVzdGFtcEhlYWRlciI6IHsKICAgICAgICAgICAgICAgICJuYW1lIjogIngtdW9zLXRpbWVzdGFtcCIsCiAgICAgICAgICAgICAgICAiaW4iOiAiaGVhZGVyIiwKICAgICAgICAgICAgICAgICJyZXF1aXJlZCI6IHRydWUsCiAgICAgICAgICAgICAgICAic2NoZW1hIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIlRpbWVzdGFtcCBmb3Igd2hlbiB0aGUgQVBJIHJlcXVlc3Qgd2FzIG1hZGUuIiwKICAgICAgICAgICAgICAgICAgICAiZm9ybWF0IjogImRhdGUtdGltZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgIlRlc3RIZWFkZXIiOiB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJ4LXVvcy10ZXN0IiwKICAgICAgICAgICAgICAgICJpbiI6ICJoZWFkZXIiLAogICAgICAgICAgICAgICAgInJlcXVpcmVkIjogdHJ1ZSwKICAgICAgICAgICAgICAgICJzY2hlbWEiOiB7CiAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAic3RyaW5nIiwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiSW5kaWNhdGVzIHdoZXRoZXIgdGhlIEFQSSByZXF1ZXN0IGlzIGEgdGVzdCBvciBhIGxpdmUgcmVxdWVzdC4iLAogICAgICAgICAgICAgICAgICAgICJlbnVtIjogWwogICAgICAgICAgICAgICAgICAgICAgICAidGVzdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJsaXZlIiwKICAgICAgICAgICAgICAgICAgICAgICAgInNhbmRib3giLAogICAgICAgICAgICAgICAgICAgICAgICAicHJvZHVjdGlvbiIKICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICJzZWN1cml0eVNjaGVtZXMiOiB7CiAgICAgICAgICAgICJiZWFyZXJBdXRoIjogewogICAgICAgICAgICAgICAgInR5cGUiOiAib2F1dGgyIiwKICAgICAgICAgICAgICAgICJmbG93cyI6IHsKICAgICAgICAgICAgICAgICAgICAiaW1wbGljaXQiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhdXRob3JpemF0aW9uVXJsIjogImh0dHBzOi8vZXhhbXBsZS5jb20vb2F1dGgyL2F1dGhvcml6ZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICJzY29wZXMiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidW9zL3N0dWRlbnQtcmVhZCI6ICJSZWFkIHN0dWRlbnQgaW5mb3JtYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInVvcy9zdHVkZW50LXJlYWQtYWxsIjogIlJlYWQgYWxsIHN0dWRlbnQgaW5mb3JtYXRpb24iCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICJhcGlLZXkiOiB7CiAgICAgICAgICAgICAgICAidHlwZSI6ICJhcGlLZXkiLAogICAgICAgICAgICAgICAgImluIjogImhlYWRlciIsCiAgICAgICAgICAgICAgICAibmFtZSI6ICJ4LWFwaS1rZXkiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0="
                  }'